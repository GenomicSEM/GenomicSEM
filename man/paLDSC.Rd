% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/paLDSC.R
\name{paLDSC}
\alias{paLDSC}
\title{Parallel Analysis Based on Multivariate LDSC}
\usage{
paLDSC(
  S = S,
  V = V,
  r = NULL,
  p = NULL,
  save.pdf = F,
  diag = F,
  fa = F,
  fm = NULL,
  nfactors = NULL
)
}
\arguments{
\item{S}{A genetic correlation matrix (\code{S_Stand}) or genetic covariance matrix (\code{S}) from LDSC output.
We recommend using the genetic correlation matrix (\code{S_Stand}) to maximize explained genetic variance.}

\item{V}{The corresponding multivariate sampling covariance matrix from LDSC (\code{V_Stand} or \code{V}),
matching the scaling of \code{S}.}

\item{r}{Number of Monte Carlo replications to simulate null correlation matrices. Default is \code{500}.}

\item{p}{Percentile threshold for significance (default = \code{0.95}). Eigenvalues from \code{S} must exceed this threshold to be considered significant.}

\item{save.pdf}{Logical. Whether to save scree plots to a PDF file. Default is \code{FALSE}.}

\item{diag}{Logical. If \code{TRUE}, diagonalized PA is performed assuming uncorrelated sampling errors. Default is \code{FALSE}.}

\item{fa}{Logical. If \code{TRUE}, also performs exploratory factor analysis and computes eigenvalues from factor solutions. Default is \code{FALSE}.}

\item{fm}{Factor extraction method used when \code{fa = TRUE}. Default is \code{"minres"}. See \code{psych::fa.parallel()}.}

\item{nfactors}{Number of factors to extract in factor analysis if \code{fa = TRUE}. Default is \code{1}.}

\item{only.values}{Logical. If \code{TRUE}, only eigenvalues are returned. Default is \code{FALSE}.}
}
\value{
A list containing observed eigenvalues, simulated eigenvalue distributions, and the suggested number of factors/components to extract.
}
\description{
\code{paLDSC} performs parallel analysis using LDSC-derived genetic (co)variance matrices to determine the number of non-spurious latent dimensions in genomic data. The function compares the eigenvalues from the LDSC matrix to those derived from null matrices generated under the multivariate LDSC sampling distribution.
}
\details{
This method adapts Horn’s (1965) classic parallel analysis approach to LDSC-based genomic data. Eigenvalues from the observed LDSC-derived matrix are compared against distributions of eigenvalues simulated under the null model using the multivariate LDSC sampling distribution. The number of components to retain is determined by comparing each observed eigenvalue to the corresponding percentile threshold from the simulated distribution.

If \code{diag = TRUE}, diagonal sampling variances are used to construct null matrices (faster, but less conservative). If \code{diag = FALSE}, the full LDSC sampling covariance matrix \code{V} is used to simulate the null distribution.

Factor analysis mode (\code{fa = TRUE}) follows the logic of \code{psych::fa.parallel}, allowing users to inspect common factor solutions.
}
\examples{
\dontrun{
# Load LDSC output
load("LDSC_output_paLDSC_example.RData")

# Run paLDSC with 10 replications
paLDSC(S = LDSCoutputfull$S_Stand, V = LDSCoutputfull$V_Stand, r = 10)
}

}
\references{
de la Fuente, J., & Tucker-Drob, E. M. (2023). *paLDSC: Parallel Analysis Based on Multivariate LDSC*. \cr
\url{https://rpubs.com/JaFuente/paLDSC}

Horn, J. L. (1965). A rationale and test for the number of factors in factor analysis. *Psychometrika*, 30(2), 179–185.
}
\seealso{
\link[psych]{fa.parallel}, \link[stats]{eigen}
}

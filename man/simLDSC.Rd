% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simLDSC.R
\name{simLDSC}
\alias{simLDSC}
\title{Simulate GWAS summary statistics for multivariate LDSC}
\usage{
simLDSC(
  covmat,
  N,
  seed,
  ld,
  rPheno = NULL,
  int = NULL,
  N_overlap = 0.99,
  r = 1,
  gzip_output = TRUE,
  parallel = FALSE,
  cores = NULL
)
}
\arguments{
\item{covmat}{A population genetic covariance matrix (Σ) or lavaan model syntax. Can be provided directly as a matrix or \code{data.frame}, or as a lavaan-style model string from which Σ is derived.}

\item{N}{A sample size matrix (or \code{data.frame}) with sample sizes on the diagonal and sample overlaps on the off-diagonal. Alternatively, a single value if using \code{N_overlap}.}

\item{seed}{An integer seed for random number generation. Default is 1234.}

\item{ld}{A path to the folder containing LD score files (e.g., \code{"eur_w_ld_chr/"}). Must exist in the working directory.}

\item{rPheno}{A phenotypic correlation matrix (\code{matrix} or \code{data.frame}) across k phenotypes, or a single numeric value to set equal phenotypic correlations.}

\item{int}{A numeric vector of LDSC intercepts (length = k), or a single numeric value if the same intercept is used for all traits.}

\item{N_overlap}{A numeric value between 0 and 1 representing the proportion of sample overlap, only used if \code{N} is a scalar. Default is 0.99.}

\item{r}{Number of replications to simulate. Default is 1.}

\item{gzip_output}{Logical. Whether to compress output summary statistics as \code{.gz} files. Default is \code{TRUE}.}

\item{parallel}{Logical. Whether to run simulations in parallel. Default is \code{FALSE}.}

\item{cores}{Integer number of cores to use if \code{parallel = TRUE}. By default, uses \code{min(k, available_cores - 1)}.}
}
\value{
The function writes simulated summary statistics files to disk for each trait and replication. No values are returned to the R environment.
}
\description{
\code{simLDSC} simulates GWAS summary statistics across multiple phenotypes given a population genetic covariance structure, phenotypic correlations, sample sizes, and LDSC intercepts. Useful for testing multivariate LDSC pipelines or validating SEM-based genomic models.
}
\details{
This function generates simulated GWAS summary statistics from a specified multivariate genetic model using LDSC assumptions. The population genetic covariance matrix can be specified either directly or via lavaan-style syntax.

The function creates \code{k} simulated summary statistics files per replication. For example, simulating 3 traits across 1 replication yields:
\itemize{
  \item \code{iter1.GWAS1.sumstats.gz}
  \item \code{iter1.GWAS2.sumstats.gz}
  \item \code{iter1.GWAS3.sumstats.gz}
}
}
\examples{
\dontrun{
# Define model-based genetic covariance matrix
mod <- "F1 =~ 1*Pheno1 + 0.50*Pheno2 + 0.50*Pheno3
        F1 ~~ 0.10*F1
        Pheno1 ~~ 0*Pheno1
        Pheno2 ~~ 0*Pheno2
        Pheno3 ~~ 0*Pheno3"

# Alternatively, specify it directly
Spop <- matrix(NA, 3, 3)
diag(Spop) <- c(0.10, 0.025, 0.025)
Spop[lower.tri(Spop)] <- c(0.05, 0.05, 0.025)
Spop[upper.tri(Spop)] <- c(0.05, 0.05, 0.025)

# Sample size matrix
N <- matrix(0, 3, 3)
diag(N) <- c(75000, 300000, 300000)

# Phenotypic correlations
rPheno <- matrix(0.5, 3, 3)
diag(rPheno) <- 1

# LDSC intercepts
int <- c(1.02, 1.01, 1.03)

# Run simulation
simLDSC(covmat = mod, N = N, rPheno = rPheno, int = int, ld = "eur_w_ld_chr/")
}

}
\references{
A complete tutorial and walkthrough is available at: \cr
\url{https://rpubs.com/JaFuente/simLDSC}
}
\seealso{
\link[lavaan]{lavaan}, \link[GenomicSEM]{ldsc}
}

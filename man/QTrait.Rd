% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/qtrait.r
\name{QTrait}
\alias{QTrait}
\title{Run the QTrait function to test trait-specific heterogeneity in genetic correlation models}
\usage{
QTrait(
  LDSCoutput,
  indicators,
  traits,
  mresid = 0.25,
  mresidthreshold = 0.1,
  lsrmr = 0.25,
  lsrmrthreshold = 0.1,
  save.plots = TRUE,
  stdout = TRUE
)
}
\arguments{
\item{LDSCoutput}{An object from the \code{ldsc()} function containing multivariate LDSC output.}

\item{indicators}{A character vector specifying the names of indicator traits that define the latent factor. Must match trait names in \code{LDSCoutput}.}

\item{traits}{A character vector of external traits for which QTrait statistics and genetic correlations will be estimated. Must match trait names in \code{LDSCoutput}.}

\item{mresid}{A proportion (default = 0.25) of the RMS genetic correlation used to flag outlier indicator traits.}

\item{mresidthreshold}{An absolute threshold (default = 0.10) for residual genetic correlation to define meaningful outliers.}

\item{lsrmr}{Proportion (default = 0.25) used to define meaningful lSRMR based on the RMS genetic correlation.}

\item{lsrmrthreshold}{Absolute threshold (default = 0.10) to define meaningful lSRMR.}

\item{save.plots}{Logical. If TRUE, saves scatterplots of traitâ€“indicator associations against loadings. Default is TRUE.}

\item{stdout}{Logical. If TRUE, plots use standardized output (correlations vs. standardized loadings). If FALSE, uses covariances vs. unstandardized loadings. Default is TRUE.}
}
\value{
A data frame summarizing genetic correlations between traits and the latent factor, QTrait statistics for both common and follow-up models, heterogeneity flags, lSRMR values, and identified outlier indicators.
}
\description{
\code{QTrait} tests whether the genetic association between a latent factor (defined by a set of indicator traits) and an external trait can be fully explained by the common factor, or whether specific indicator traits show heterogeneity in this relationship.
}
\details{
\strong{Common Pathway Model Output} includes:
\itemize{
  \item \code{rGF1Trait_CPM}, \code{SErGF1Trait_CPM}, \code{pvalrGF1Trait_CPM}: Genetic correlation, standard error, and p-value.
  \item \code{QTrait_CPM}, \code{df_CPM}, \code{p_value_CPM}, \code{Qsignificant_CPM}: Q statistic, degrees of freedom, and p-value.
  \item \code{lSRMR_CPM}, \code{lSRMR_above_threshold_CPM}, \code{heterogeneity_CPM}: Local SRMR and heterogeneity status.
}

\strong{Follow-Up Model Output} includes analogous statistics when outlier indicators are freed:
\itemize{
  \item \code{rGF1Trait_FUM}, \code{SErGF1Trait_FUM}, \code{pvalrGF1Trait_FUM}
  \item \code{QTrait_FUM}, \code{df_FUM}, \code{p_value_FUM}, \code{Qsignificant_FUM}
  \item \code{lSRMR_FUM}, \code{lSRMR_above_threshold_FUM}, \code{heterogeneity_FUM}
  \item \code{Unconstrained_paths}: Names of outlier indicator traits.
}
}
\examples{
\dontrun{
# Load example LDSC output
load("LDSC_G_factor_QTRAIT_tutorial.RData")

# Define indicators of genetic g
indicators <- c("Matrix", "Memory", "RT", "Symbol_Digit", "TMTB", "Tower", "VNR")

# Define external correlate
traits <- "EA"

# Run QTrait
qtrait_out <- QTrait(
  LDSCoutput = LDSC_G_factor_QTRAIT_tutorial,
  indicators = indicators,
  traits = traits,
  mresid = 0.25,
  mresidthreshold = 0.10,
  lsrmr = 0.25,
  lsrmrthreshold = 0.10,
  save.plots = TRUE,
  stdout = TRUE
)

print(qtrait_out)
}

}
\references{
\url{https://rpubs.com/JaFuente/QTrait}
}
\author{
Javier de la Fuente
}
